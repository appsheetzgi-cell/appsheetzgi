<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ðŸ“Š Monitoring Produksi Realtime</title>

<style>
  body {
    font-family: 'Segoe UI', Arial, sans-serif;
    background-color: #f4f6f8;
    margin: 0;
    padding: 0;
  }

  /* HEADER TEKS BERJALAN */
  .marquee {
    background: #083D36;
    color: white;
    padding: 10px 0;
    font-size: 40px;
    font-weight: bold;
    text-align: center;
    overflow: hidden;
    white-space: nowrap;
  }

  h2 {
    text-align: center;
    margin: 10px 0;
    color: #333;
  }

  .container {
    width: 96%;
    margin: 15px auto;
    background: white;
    border-radius: 10px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    overflow-x: auto;
  }

  table {
    width: 100%;
    border-collapse: collapse;
  }

  th, td {
    padding: 10px 5px;
    text-align: center;
    font-size: 24px;
    border: 1px solid #ddd;
  }

  th {
    background: #083D36;
    color: white;
  }

  tr:nth-child(even) {
    background-color: #f9f9f9;
  }

  tr:hover {
    background-color: #e3f2fd;
  }

  .footer {
    text-align: right;
    font-size: 20px;
    color: #555;
    padding: 5px;
  }

  /* TOTAL OUTPUT BOX */
  .top-bar {
    display: flex;
    justify-content: space-between;
    width: 96%;
    margin: 10px auto;
  }

  .total-wrapper {
    width: 70%;
  }

  .total-table th, .total-table td {
    font-size: 26px;
    font-weight: bold;
  }

  /* JAM */
  .total-wrapper1 {
    width: 30%;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  #tanggal {
    font-size: 20px;
    font-weight: 600;
  }

  #jam {
    font-size: 45px;
    font-weight: bold;
    color: #006400;
  }
</style>
</head>
<body>

<!-- TEKS BERJALAN -->
<div class="marquee">
  <marquee behavior="scroll" direction="left" scrollamount="10">
    HOURLY MONITORING SPRING PACKING
  </marquee>
</div>

<!-- SHIFT 1 -->
<div class="container">
  <h2>SPRING PACKING TARGET : 60 PC/JAM</h2>
  <table id="tableShift1">
    <thead>
      <tr>
        <th>LINE</th><th>09:00</th><th>10:00</th><th>11:00</th><th>12:00</th>
        <th>14:00</th><th>15:00</th><th>16:00</th><th>17:00</th><th>18:00</th><th>19:30</th>
        <th>AVG</th><th>TOTAL</th>
      </tr>
    </thead>
    <tbody id="bodyShift1">
      <tr><td colspan="13">Loading data...</td></tr>
    </tbody>
  </table>
  <div class="footer">Auto-refresh setiap 30 detik</div>
</div>

<!-- SHIFT 2 -->
<div class="container">
  <table id="tableShift2">
    <thead>
      <tr>
        <th>LINE</th><th>21:00</th><th>22:00</th><th>23:00</th><th>00:00</th>
        <th>02:00</th><th>03:00</th><th>04:00</th><th>05:00</th><th>06:30</th><th>07:30</th>
        <th>AVG</th><th>TOTAL</th>
      </tr>
    </thead>
    <tbody id="bodyShift2">
      <tr><td colspan="13">Loading data...</td></tr>
    </tbody>
  </table>
  <div class="footer" id="status">Auto-refresh setiap 30 detik</div>
</div>

<!-- TOTAL OUTPUT + JAM -->
<div class="top-bar">
  <div class="total-wrapper">
    <table class="total-table">
      <thead>
        <tr>
          <th colspan="2">OUTPUT SHIFT 1</th>
          <th colspan="2">OUTPUT SHIFT 2</th>
          <th colspan="2">TOTAL OUTPUT</th>
        </tr>
      </thead>
      <tbody id="bodyTotalOutput">
        <tr>
          <td colspan="2" rowspan="2">0</td>
          <td colspan="2" rowspan="2">0</td>
          <td colspan="2" rowspan="2">0</td>
        </tr>
        <tr></tr>
      </tbody>
    </table>
  </div>

  <div class="total-wrapper1">
    <div id="tanggal"></div>
    <div id="jam"></div>
  </div>
</div>

<footer class="footer">Â© Zinus Global Indonesia | Factory 2 Karawang</footer>

<script>
const SHEET_URL = "LINK_CSV_KAMU_DI_SINI"; // GANTI INI

async function loadSheetData() {
  try {
    const response = await fetch(SHEET_URL + "&t=" + Date.now());
    const txt = await response.text();
    const rows = txt.trim().split("\n").map(r => r.split(","));

    const shift1Body = document.getElementById("bodyShift1");
    const shift2Body = document.getElementById("bodyShift2");
    const totalBody  = document.getElementById("bodyTotalOutput");

    shift1Body.innerHTML = "";
    shift2Body.innerHTML = "";

    // SHIFT 1 â†’ baris 7-10
    rows.slice(6, 10).forEach(r => {
      let tr = "<tr>";
      r.slice(0, 13).forEach(cell => tr += `<td>${cell}</td>`);
      tr += "</tr>";
      shift1Body.innerHTML += tr;
    });

    // SHIFT 2 â†’ baris 15-18
    rows.slice(14, 18).forEach(r => {
      let tr = "<tr>";
      r.slice(0, 13).forEach(cell => tr += `<td>${cell}</td>`);
      tr += "</tr>";
      shift2Body.innerHTML += tr;
    });

    // TOTAL OUTPUT â†’ baris ke-21 (index 20)
    const total = rows[20];
    const s1 = total[0] || "0";
    const s2 = total[1] || "0";
    const tt = total[2] || "0";

    totalBody.innerHTML = `
      <tr>
        <td colspan="2" rowspan="2">${s1}</td>
        <td colspan="2" rowspan="2">${s2}</td>
        <td colspan="2" rowspan="2">${tt}</td>
      </tr>
      <tr></tr>
    `;

    document.getElementById("status").textContent =
      "Diperbarui: " + new Date().toLocaleTimeString("id-ID");

  } catch (e) {
    document.getElementById("status").textContent = "Gagal ambil data!";
  }
}

function updateClock() {
  const now = new Date();
  document.getElementById("tanggal").textContent = now.toLocaleDateString("id-ID", {
    weekday: 'long', year: 'numeric', month: 'long', day: 'numeric'
  });
  document.getElementById("jam").textContent = now.toLocaleTimeString("id-ID", { hour12: false });
}

setInterval(updateClock, 1000);
updateClock();

loadSheetData();
setInterval(loadSheetData, 30000);
</script>

</body>
</html>
