<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üìä Monitoring Produksi Realtime</title>

<!-- ‚úÖ Tambah Bootstrap (versi stabil 5.3) -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
/* CSS kamu tetap sama persis */
body {
  font-family: 'Segoe UI', Arial, sans-serif;
  background-color: #f4f6f8;
  margin: 0;
  padding: 0;
  overflow-x: hidden;
}

/* ... (semua CSS yang kamu kirimkan tadi tetap sama, tidak ada perubahan) ... */
</style>
</head>

<body>

<!-- === TEKS BERJALAN === -->
<div class="marquee">
  <marquee behavior="scroll" direction="left" scrollamount="6">
    HOURLY MONITORING TOPPER PACKING DAN FOAM PACKING
  </marquee>
</div>

<!-- === TABEL TOPPER === -->
<div class="container-fluid px-2">
  <div class="container bg-white rounded shadow-sm p-0">
    <div class="h2-header">
      <select id="shiftSelector" class="form-select border-0 bg-transparent fw-bold text-success" style="font-size:clamp(30px,2.5vw,35px);width:auto;">
        <option value="1" selected>SHIFT 1</option>
        <option value="2">SHIFT 2</option>
      </select>
      <h2>TOPPER PACKING TARGET : 90 PC/JAM</h2>
      <div style="width:80px;"></div>
    </div>

    <div class="table-responsive">
      <table id="tableTopper" class="table table-bordered table-hover mb-0">
        <thead>
          <tr>
            <th>LINE</th><th>09:00</th><th>10:00</th><th>11:00</th><th>12:00</th>
            <th>14:00</th><th>15:00</th><th>16:00</th><th>17:00</th>
            <th>18:00</th><th>19:30</th><th>AVG</th><th>TOTAL</th>
          </tr>
        </thead>
        <tbody id="bodyTopper">
          <tr><td colspan="13">Loading data...</td></tr>
        </tbody>
      </table>
    </div>
    <div class="footer">Auto-refresh setiap 30 detik</div>
  </div>
</div>

<!-- === FOAM PACKING === -->
<div class="container-fluid px-2 mt-2">
  <div class="container bg-white rounded shadow-sm p-0">
    <h2 class="text-center">FOAM PACKING TARGET : 75 PC/JAM</h2>
    <div class="table-responsive">
      <table id="tableFoam" class="table table-bordered table-hover mb-0">
        <thead>
          <tr>
            <th>LINE</th><th>09:00</th><th>10:00</th><th>11:00</th><th>12:00</th>
            <th>14:00</th><th>15:00</th><th>16:00</th><th>17:00</th>
            <th>18:00</th><th>19:30</th><th>AVG</th><th>TOTAL</th>
          </tr>
        </thead>
        <tbody id="bodyFoam">
          <tr><td colspan="13">Loading data...</td></tr>
        </tbody>
      </table>
    </div>
    <div class="footer" id="status">Auto-refresh setiap 30 detik</div>
  </div>
</div>

<!-- === TOTAL & JAM === -->
<div class="top-bar container-fluid mt-3">
  <div class="total-wrapper">
    <div class="table-responsive">
      <table class="total-table table table-bordered mb-0">
        <thead>
          <tr>
            <th colspan="2">OUTPUT SHIFT 1</th>
            <th colspan="2">OUTPUT SHIFT 2</th>
          </tr>
          <tr>
            <th>TOPPER</th>
            <th>FOAM</th>
            <th>TOPPER</th>
            <th>FOAM</th>
          </tr>
        </thead>
        <tbody id="bodyTotalOutput">
          <tr><td>0</td><td>0</td><td>0</td><td>0</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <div class="total-wrapper1">
    <div id="tanggal"></div>
    <div id="jam"></div>
    <div class="logo-row">
      <img src="logo-zinus1.gif" alt="Zinus Logo" class="zinus-logo1 img-fluid">
      <img src="Hyundai_Logo.png" alt="Hyundai Logo" class="zinus-logo img-fluid">
    </div>
  </div>
</div>

<footer class="footer-zinus">
  <p>¬© Zinus Global Indonesia | Factory 2 Karawang</p>
</footer>

<!-- ‚úÖ Bootstrap JS Bundle -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<!-- ‚úÖ Script kamu tetap sama -->
<script>
/* === Script asli tetap 100% sama === */
const SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTo_FFsfIx50Tgyzo2JZneIQtNBfIpP6eJ-KhzS1qenNIqy7rjmMaE1h1H5X2e_-7jdCbcwq6wdk5oL/pub?gid=773938712&single=true&output=csv";

async function loadSheetData() {
  const status = document.getElementById("status");
  try {
    status.textContent = "üîÑ Memuat data...";
    const response = await fetch(SHEET_URL + "&t=" + Date.now(), { cache: "no-store" });
    const text = await response.text();
    const rows = text.trim().split("\n").map(r => r.split(","));
    const topperBody = document.getElementById("bodyTopper");
    const foamBody = document.getElementById("bodyFoam");
    topperBody.innerHTML = "";
    foamBody.innerHTML = "";

    const topperRows = rows.slice(5, 8);
    const foamRows = rows.slice(11, 17);

    topperRows.forEach(row => {
      const tr = document.createElement("tr");
      row.slice(0, 13).forEach((cell, index) => {
        const td = document.createElement("td");
        td.textContent = cell;
        td.style.fontSize = "35px";
        td.style.fontWeight = "bold";
        const v = parseFloat(cell.replace(/[^0-9.]/g, ""));
        if (index > 0 && !isNaN(v) && v < 90 && v > 0) {
          td.style.backgroundColor = "#ffcccc";
          td.style.color = "#a80000";
        }
        tr.appendChild(td);
      });
      topperBody.appendChild(tr);
    });

    foamRows.forEach(row => {
      const tr = document.createElement("tr");
      row.slice(0, 13).forEach((cell, index) => {
        const td = document.createElement("td");
        td.textContent = cell;
        td.style.fontSize = "35px";
        td.style.fontWeight = "bold";
        const v = parseFloat(cell.replace(/[^0-9.]/g, ""));
        if (index > 0 && !isNaN(v) && v < 75 && v > 0) {
          td.style.backgroundColor = "#ffcccc";
          td.style.color = "#a80000";
        }
        tr.appendChild(td);
      });
      foamBody.appendChild(tr);
    });

    const totalRow = rows[19];
    if (totalRow) {
      document.getElementById("bodyTotalOutput").innerHTML = `
        <tr>
          <td style="font-size:45px;">${totalRow[0] || 0}</td>
          <td style="font-size:45px;">${totalRow[1] || 0}</td>
          <td style="font-size:45px;">${totalRow[2] || 0}</td>
          <td style="font-size:45px;">${totalRow[3] || 0}</td>
        </tr>`;
    }

    status.textContent = "‚úÖ Diperbarui: " + new Date().toLocaleTimeString("id-ID");
  } catch {
    status.textContent = "‚ö†Ô∏è Gagal memuat data";
  }
}

function updateClock() {
  const now = new Date();
  document.getElementById("tanggal").textContent = now.toLocaleDateString("id-ID", { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
  document.getElementById("jam").textContent = now.toLocaleTimeString("id-ID", { hour12: false });
}

setInterval(updateClock, 1000);
updateClock();
loadSheetData();
setInterval(loadSheetData, 30000);

document.getElementById("shiftSelector").addEventListener("change", function() {
  const v = this.value;
  window.location.href = v === "2" ? "shift2.html" : "index.html";
});
</script>
</body>
</html>
