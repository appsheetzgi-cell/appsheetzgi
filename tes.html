<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üìä Monitoring Produksi Realtime</title>
<style>
  body {
    font-family: 'Segoe UI', Arial, sans-serif;
    background-color: #f4f6f8;
    margin: 0;
    padding: 0;
  }

  .marquee {
    background: #1976d2;
    color: white;
    padding: 10px 0;
    font-size: 22px;
    font-weight: bold;
    text-align: center;
    overflow: hidden;
    white-space: nowrap;
  }

  h2 {
    text-align: center;
    color: #333;
    margin: 25px 0 10px;
    font-size: 22px;
  }

  .container {
    width: 95%;
    max-width: 1200px;
    margin: 15px auto;
    background: white;
    border-radius: 10px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    overflow-x: auto;
    padding: 0;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    table-layout: auto;
  }

  th, td {
    padding: 10px 6px;
    text-align: center;
    font-size: 25px;
  }

  th {
    background: #1976d2;
    color: white;
  }

  tr:nth-child(even) { background-color: #f9f9f9; }
  tr:hover { background-color: #e3f2fd; }

  .footer {
    text-align: right;
    font-size: 12px;
    padding: 8px;
    background: #f1f1f1;
    color: #666;
    border-top: 1px solid #ddd;
    border-bottom-left-radius: 10px;
    border-bottom-right-radius: 10px;
  }

  .loading {
    text-align: center;
    padding: 20px;
    color: #999;
  }

  .clock {
    text-align: center;
    font-size: 20px;
    color: #333;
    margin: 25px 0 5px;
    font-weight: 500;
  }

  .status {
    text-align: center;
    font-size: 14px;
    color: #444;
    margin-bottom: 25px;
  }

  @media (max-width: 600px) {
    .marquee {
      font-size: 16px;
      padding: 8px 0;
    }
    th, td {
      font-size: 13px;
      padding: 6px 4px;
    }
    h2 {
      font-size: 18px;
    }
    .clock {
      font-size: 16px;
    }
  }
</style>
</head>
<body>

<!-- === TEKS BERJALAN === -->
<div class="marquee">
  <marquee behavior="scroll" direction="left" scrollamount="6">
    üìä Hourly Monitoring Packing Topper dan Packing Foam üì¶
  </marquee>
</div>

<!-- === TABEL TOPPER === -->
<h2>üì¶ Monitoring Packing TOPPER</h2>
<div class="container">
  <table id="tableTopper">
    <thead>
      <tr>
        <th>LINE</th><th>09:00</th><th>10:00</th><th>11:00</th><th>12:00</th>
        <th>14:00</th><th>15:00</th><th>16:00</th><th>17:00</th><th>18:00</th><th>19:30</th><th>AVG</th><th>TOTAL</th>
      </tr>
    </thead>
    <tbody id="bodyTopper">
      <tr><td class="loading" colspan="13">Loading data...</td></tr>
    </tbody>
  </table>
  <div class="footer">Auto-refresh setiap 30 detik</div>
</div>

<!-- === TABEL FOAM === -->
<h2>üß± Monitoring Packing FOAM</h2>
<div class="container">
  <table id="tableFoam">
    <thead>
      <tr>
        <th>LINE</th><th>09:00</th><th>10:00</th><th>11:00</th><th>12:00</th>
        <th>14:00</th><th>15:00</th><th>16:00</th><th>17:00</th><th>18:00</th><th>19:30</th><th>AVG</th><th>TOTAL</th>
      </tr>
    </thead>
    <tbody id="bodyFoam">
      <tr><td class="loading" colspan="13">Loading data...</td></tr>
    </tbody>
  </table>
  <div class="footer">Auto-refresh setiap 30 detik</div>
</div>

<!-- === TABEL TOTAL === -->
<div class="container">
  <table id="tableTotal">
    <thead>
      <tr>
        <th>TOTAL TOPPER</th><th>TOTAL FOAM</th>
      </tr>
    </thead>
    <tbody id="bodyTotal">
      <tr><td class="loading" colspan="2">Menunggu data total...</td></tr>
    </tbody>
  </table>
</div>

<!-- === JAM & STATUS PEMBARUAN === -->
<div class="clock" id="clock">üïí Memuat jam...</div>
<div class="status" id="status">‚è≥ Memuat data...</div>

<script>
const SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTo_FFsfIx50Tgyzo2JZneIQtNBfIpP6eJ-KhzS1qenNIqy7rjmMaE1h1H5X2e_-7jdCbcwq6wdk5oL/pub?gid=773938712&single=true&output=csv";

async function loadSheetData() {
  const status = document.getElementById("status");
  try {
    status.textContent = "üîÑ Memuat data...";
    const response = await fetch(SHEET_URL + "&t=" + Date.now(), {cache:"no-store"});
    if (!response.ok) throw new Error("Gagal ambil data (" + response.status + ")");
    const text = await response.text();
    const rows = text.trim().split("\n").map(r => r.split(","));

    const topperBody = document.getElementById("bodyTopper");
    const foamBody = document.getElementById("bodyFoam");
    const totalBody = document.getElementById("bodyTotal");

    topperBody.innerHTML = "";
    foamBody.innerHTML = "";
    totalBody.innerHTML = "";

    const topperRows = rows.slice(1, 4);
    const foamRows = rows.slice(7, 12);
    const totalRows = rows.slice(14, 15); // misal baris total di sheet-nya ada di bawah

    topperRows.forEach(row => {
      const tr = document.createElement("tr");
      row.slice(0, 13).forEach(cell => {
        const td = document.createElement("td");
        td.textContent = cell;
        tr.appendChild(td);
      });
      topperBody.appendChild(tr);
    });

    foamRows.forEach(row => {
      const tr = document.createElement("tr");
      row.slice(0, 13).forEach(cell => {
        const td = document.createElement("td");
        td.textContent = cell;
        tr.appendChild(td);
      });
      foamBody.appendChild(tr);
    });

    totalRows.forEach(row => {
      const tr = document.createElement("tr");
      row.slice(0, 2).forEach(cell => {
        const td = document.createElement("td");
        td.textContent = cell;
        tr.appendChild(td);
      });
      totalBody.appendChild(tr);
    });

    const now = new Date();
    status.textContent = "‚úÖ Diperbarui: " + now.toLocaleTimeString("id-ID");

  } catch (err) {
    console.error("Fetch error:", err);
    status.textContent = "‚ö†Ô∏è Gagal memuat data";
  }
}

function updateClock() {
  const clock = document.getElementById("clock");
  const now = new Date();
  const waktu = now.toLocaleTimeString("id-ID", {hour12:false});
  const tanggal = now.toLocaleDateString("id-ID", {weekday:'long', year:'numeric', month:'long', day:'numeric'});
  clock.innerHTML = `üìÖ ${tanggal} | üïí ${waktu}`;
}

setInterval(updateClock, 1000);
updateClock();

loadSheetData();
setInterval(loadSheetData, 30000);
</script>

</body>
</html>
