<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8">
<title>Data Realtime dari Google Sheet</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; }
  table { border-collapse: collapse; width: 100%; }
  th, td {
    border: 1px solid #ddd;
    padding: 8px;
    text-align: center;
  }
  th {
    background-color: #333;
    color: white;
  }
</style>
</head>
<body>
<h2>üìä Data Realtime dari Google Sheet</h2>

<table id="dataTable">
  <thead>
    <tr>
      <th>Line</th>
      <th>08:00~09:00</th>
      <th>09:00~10:00</th>
      <th>10:00~11:00</th>
      <th>11:00~12:00</th>
      <th>13:00~14:00</th>
      <th>14:00~15:00</th>
      <th>15:00~16:00</th>
      <th>16:00~17:00</th>
      <th>17:00~18:00</th>
      <th>AVG</th>
      <th>Total</th>
    </tr>
  </thead>
  <tbody id="tableBody">
    <tr><td colspan="10">Loading...</td></tr>
  </tbody>
</table>

<script>
// === URL CSV kamu dari "Publish to Web" ===
const SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTo_FFsfIx50Tgyzo2JZneIQtNBfIpP6eJ-KhzS1qenNIqy7rjmMaE1h1H5X2e_-7jdCbcwq6wdk5oL/pub?gid=773938712&single=true&output=csv";

async function loadSheetData() {
  try {
    const response = await fetch(SHEET_URL + "&t=" + Date.now(), {cache:"no-store"});
    if (!response.ok) throw new Error("Gagal ambil data (" + response.status + ")");
    const text = await response.text();

    // parsing CSV
    const rows = text.trim().split("\n").map(r => r.split(","));
    const tbody = document.getElementById("tableBody");
    tbody.innerHTML = ""; // hapus isi lama

    // loop data mulai dari baris ke-2 (karena baris pertama header)
    rows.slice(1).forEach(row => {
      const tr = document.createElement("tr");
      row.forEach(cell => {
        const td = document.createElement("td");
        td.textContent = cell;
        tr.appendChild(td);
      });
      tbody.appendChild(tr);
    });

  } catch (err) {
    console.error("Fetch error:", err);
    document.getElementById("tableBody").innerHTML =
      `<tr><td colspan="10">‚ùå Error: ${err.message}</td></tr>`;
  }
}

// Jalankan pertama kali
loadSheetData();
// Lalu auto refresh setiap 30 detik
setInterval(loadSheetData, 30000);
</script>

</body>
</html>
