<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ðŸ“Š Monitoring Produksi Realtime</title>
<style>
  body {
    font-family: 'Segoe UI', Arial, sans-serif;
    background-color: #f4f6f8;
    margin: 0;
    padding: 0;
  }

  .marquee {
    background: #083D36;
    color: white;
    padding: 10px 0;
    font-size: 40px;
    font-weight: bold;
    text-align: center;
    overflow: hidden;
    white-space: nowrap;
  }

  h2 {
    text-align: center;
    color: #333;
    margin: 10px 0 10px;
    font-size: 22px;
  }

  .container {
    width: 95%;
    margin: 15px auto;
    background: white;
    border-radius: 10px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    overflow-x: auto;
    padding: 0;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    table-layout: fixed;
  }

  th, td {
    padding: 10px 6px;
    text-align: center;
    font-size: 25px;
  }

  th {
    background: #083D36;
    color: white;
  }

  tr:nth-child(even) { background-color: #f9f9f9; }
  tr:hover { background-color: #e3f2fd; }

  /* === TABEL TOTAL GABUNG === */
  .total-container {
    width: 70%;
    margin: 30px auto 0;
    background: white;
    border-radius: 10px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.15);
    overflow: hidden;
  }

  .total-container table {
    width: 100%;
    border-collapse: collapse;
  }

  .total-container th, .total-container td {
    border: 1px solid #ccc;
    padding: 15px;
    text-align: center;
    font-size: 24px;
  }

  .total-container th {
    background: #083D36;
    color: white;
  }

  .total-container td {
    font-weight: bold;
    color: #083D36;
  }

  /* === JAM DAN LOGO === */
  .top-bar {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin: 30px 3% 10px;
    flex-wrap: wrap;
  }

  .total-wrapper1 {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    margin-right: 3%;
    text-align: center;
  }

  #tanggal {
    font-size: 20px;
    font-weight: 600;
    color: #333;
  }

  #jam {
    font-size: 40px;
    font-weight: bold;
    color: #006400;
    margin-top: 5px;
    text-align: center;
  }

  .logo-row {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 15px;
  }

  .zinus-logo, .zinus-logo1 {
    width: 60px;
    height: 60px;
    border-radius: 10px;
    background: white;
    object-fit: contain;
    box-shadow: 0 2px 6px rgba(0,0,0,0.2);
  }

  /* === FOOTER === */
  .footer-zinus {
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    background: #083D36;
    color: white;
    padding: 20px 10px;
    border-top: 4px solid #004d00;
    margin-top: 20px;
  }
</style>
</head>
<body>

<!-- === TEKS BERJALAN === -->
<div class="marquee">
  <marquee behavior="scroll" direction="left" scrollamount="6">
    HOURLY MONITORING TOPPER PACKING DAN FOAM PACKING
  </marquee>
</div>

<!-- === TABEL TOTAL GABUNG === -->
<div class="total-container">
  <table>
    <thead>
      <tr>
        <th colspan="2">SHIFT 1</th>
        <th colspan="2">SHIFT 2</th>
      </tr>
      <tr>
        <th>Topper</th>
        <th>Foam</th>
        <th>Topper</th>
        <th>Foam</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td id="totalTopper1">0</td>
        <td id="totalFoam1">0</td>
        <td id="totalTopper2">0</td>
        <td id="totalFoam2">0</td>
      </tr>
    </tbody>
  </table>
</div>

<!-- === TABEL TOPPER === -->
<div class="container">
  <h2>TOPPER PACKING TARGET : 90 Pcs/Jam</h2>
  <table id="tableTopper">
    <thead>
      <tr>
        <th>LINE</th><th>09:00</th><th>10:00</th><th>11:00</th><th>12:00</th>
        <th>14:00</th><th>15:00</th><th>16:00</th><th>17:00</th><th>18:00</th><th>19:30</th><th>AVG</th><th>TOTAL</th>
      </tr>
    </thead>
    <tbody id="bodyTopper">
      <tr><td colspan="13">Loading data...</td></tr>
    </tbody>
  </table>
</div>

<!-- === TABEL FOAM === -->
<div class="container">
  <h2>FOAM PACKING TARGET : 75 Pcs/Jam</h2>
  <table id="tableFoam">
    <thead>
      <tr>
        <th>LINE</th><th>09:00</th><th>10:00</th><th>11:00</th><th>12:00</th>
        <th>14:00</th><th>15:00</th><th>16:00</th><th>17:00</th><th>18:00</th><th>19:30</th><th>AVG</th><th>TOTAL</th>
      </tr>
    </thead>
    <tbody id="bodyFoam">
      <tr><td colspan="13">Loading data...</td></tr>
    </tbody>
  </table>
</div>

<!-- === JAM & LOGO === -->
<div class="top-bar">
  <div class="total-wrapper1">
    <div id="tanggal"></div>
    <div id="jam"></div>
    <div class="logo-row">
      <img src="logo-zinus1.gif" alt="Zinus Logo" class="zinus-logo1">
      <img src="Hyundai_Logo.png" alt="Hyundai Logo" class="zinus-logo">
    </div>
  </div>
</div>

<footer class="footer-zinus">
  <p>Â© Zinus Global Indonesia | Factory 2 Karawang</p>  
</footer>

<script>
const SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTo_FFsfIx50Tgyzo2JZneIQtNBfIpP6eJ-KhzS1qenNIqy7rjmMaE1h1H5X2e_-7jdCbcwq6wdk5oL/pub?gid=773938712&single=true&output=csv";

async function loadSheetData() {
  try {
    const response = await fetch(SHEET_URL + "&t=" + Date.now());
    const text = await response.text();
    const rows = text.trim().split("\n").map(r => r.split(","));

    const topperRows = rows.slice(5, 8);
    const foamRows = rows.slice(11, 16);
    const totalRow = rows[18]; // sama kayak versi kamu sebelumnya

    document.getElementById("bodyTopper").innerHTML = topperRows.map(r => 
      `<tr>${r.slice(0, 13).map(c => `<td>${c}</td>`).join("")}</tr>`).join("");

    document.getElementById("bodyFoam").innerHTML = foamRows.map(r => 
      `<tr>${r.slice(0, 13).map(c => `<td>${c}</td>`).join("")}</tr>`).join("");

    // tampilkan total shift 1 & 2
    if (totalRow) {
      document.getElementById("totalTopper1").textContent = totalRow[0] || "0";
      document.getElementById("totalFoam1").textContent   = totalRow[1] || "0";
      document.getElementById("totalTopper2").textContent = totalRow[2] || "0";
      document.getElementById("totalFoam2").textContent   = totalRow[3] || "0";
    }
  } catch (err) {
    console.error(err);
  }
}

function updateClock() {
  const now = new Date();
  document.getElementById("tanggal").textContent = now.toLocaleDateString("id-ID", { weekday:'long', year:'numeric', month:'long', day:'numeric' });
  document.getElementById("jam").textContent = now.toLocaleTimeString("id-ID", { hour12:false });
}

setInterval(updateClock, 1000);
updateClock();
loadSheetData();
setInterval(loadSheetData, 30000);
</script>
</body>
</html>
